# Windows Package Manager (WinGet) Manifests

This directory contains WinGet manifest templates for submitting Biome to the Windows Package Manager Community Repository.

## Initial Setup

Before you can use the automated WinGet workflow, you need to manually submit the initial package to the WinGet Community Repository. This is a one-time process.

### Prerequisites

1. Install the [WinGet CLI](https://github.com/microsoft/winget-cli)
2. Install [winget-create](https://github.com/microsoft/winget-create) tool:
   ```bash
   winget install Microsoft.WingetCreate
   ```

### Manual Submission Process

#### Method 1: Using wingetcreate.exe

The recommended approach is to use `wingetcreate.exe` to automatically generate and submit the manifests:

1. **For creating a new package** (first-time submission):
   ```bash
   wingetcreate.exe new -o ./winget
   ```

2. **For updating an existing package**:
   ```bash
   # Update and submit to GitHub in one command
   wingetcreate.exe update --submit --token <GitHubPersonalAccessToken> --urls https://github.com/biomejs/biome/releases/download/@biomejs/biome@VERSION/biome-win32-x64.exe https://github.com/biomejs/biome/releases/download/@biomejs/biome@VERSION/biome-win32-arm64.exe --version VERSION BiomeJS.Biome
   ```

3. **For local testing** (generates manifests to a directory without submitting):
   ```bash
   # Generate manifests locally for review
   wingetcreate.exe update --out ./manifests --urls https://github.com/biomejs/biome/releases/download/@biomejs/biome@VERSION/biome-win32-x64.exe https://github.com/biomejs/biome/releases/download/@biomejs/biome@VERSION/biome-win32-arm64.exe --version VERSION BiomeJS.Biome
   ```

4. **For submitting locally generated manifests** (once the team is happy with the manifests):
   ```bash
   # Submit manifests that were generated locally
   wingetcreate.exe submit --prtitle <PullRequestTitle> --token <GitHubPersonalAccessToken>
   
   # Use --replace to replace an existing manifest from the Windows Package Manager repo
   wingetcreate.exe submit --prtitle <PullRequestTitle> --token <GitHubPersonalAccessToken> --replace
   ```


## Automated Updates

Once the initial package is submitted and merged, the automated workflow in `.github/workflows/winget.yml` will handle future updates automatically when new releases are published.

> **Note**: The automation is already set up and working! New CLI releases tagged with `@biomejs/biome@*` will automatically trigger WinGet package updates.

### Setting up the Automation

1. **Create a Personal Access Token (PAT)**:
   - Go to GitHub Settings → Developer settings → Personal access tokens
   - Create a classic token with `public_repo` scope
   - Add it as a repository secret named `WINGET_TOKEN`

2. **The automation will**:
   - Trigger on new releases tagged with `@biomejs/biome@*`
   - Extract the version from the release tag
   - Download and install the latest `wingetcreate.exe` tool
   - Submit the package update to WinGet automatically using Microsoft's official tooling
   - Support both x64 and ARM64 architectures automatically

**Note**: Unlike third-party actions, using the official `wingetcreate.exe` tool eliminates the need to maintain a fork of the winget-pkgs repository.

## Package Information

- **Package Identifier**: `BiomeJS.Biome`
- **Publisher**: Biome Developers and Contributors
- **Package Name**: Biome
- **License**: MIT OR Apache-2.0
- **Supported Architectures**: x64, arm64
- **Installation Type**: Portable executable (single binary)

### Testing Locally

Before submitting, you can test the manifests generated by wingetcreate.exe:

You will need to run `winget settings --enable LocalManifestFiles` in an administrative shell before working with local manifests.

```bash
# First, generate manifests locally for testing
wingetcreate.exe update --out ./manifests --urls https://github.com/biomejs/biome/releases/download/@biomejs/biome@VERSION/biome-win32-x64.exe https://github.com/biomejs/biome/releases/download/@biomejs/biome@VERSION/biome-win32-arm64.exe --version VERSION BiomeJS.Biome

# Validate the generated manifests
winget validate manifests/b/BiomeJS/Biome/VERSION/

# Test installation (if the package is already in WinGet)
winget install --manifest manifests/b/BiomeJS/Biome/VERSION/
```

## Resources

- [WinGet Package Manager Documentation](https://docs.microsoft.com/en-us/windows/package-manager/)
- [WinGet Manifest Schema](https://github.com/microsoft/winget-cli/tree/master/schemas)
- [WinGet Community Repository](https://github.com/microsoft/winget-pkgs)
- [WinGet Create Tool](https://github.com/microsoft/winget-create) 
