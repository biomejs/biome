---
source: crates/biome_js_analyze/tests/spec_tests.rs
expression: nested-calls.js
---
# Input
```js
/* should generate diagnostics */
// Test nested element handle calls
const button1 = await (await page.$("button"));

const button2 = await page.$("#foo");

await (await page.$$("div"));

let handle;
handle = await page.$("input");

```

# Diagnostics
```
nested-calls.js:3:30 lint/nursery/noPlaywrightElementHandle  FIXABLE  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  i Unexpected use of element handles.
  
    1 │ /* should generate diagnostics */
    2 │ // Test nested element handle calls
  > 3 │ const button1 = await (await page.$("button"));
      │                              ^^^^^^^^^^^^^^^^
    4 │ 
    5 │ const button2 = await page.$("#foo");
  
  i Locators auto-wait and are more reliable than element handles, which can become stale.
  
  i Use page.locator() or getByRole() instead.
  
  i This rule belongs to the nursery group, which means it is not yet stable and may change in the future. Visit https://biomejs.dev/linter/#nursery for more information.
  
  i Unsafe fix: Replace $() with locator().
  
     1  1 │   /* should generate diagnostics */
     2  2 │   // Test nested element handle calls
     3    │ - const·button1·=·await·(await·page.$("button"));
        3 │ + const·button1·=·await·(await·page.locator("button"));
     4  4 │   
     5  5 │   const button2 = await page.$("#foo");
  

```

```
nested-calls.js:5:23 lint/nursery/noPlaywrightElementHandle  FIXABLE  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  i Unexpected use of element handles.
  
    3 │ const button1 = await (await page.$("button"));
    4 │ 
  > 5 │ const button2 = await page.$("#foo");
      │                       ^^^^^^^^^^^^^^
    6 │ 
    7 │ await (await page.$$("div"));
  
  i Locators auto-wait and are more reliable than element handles, which can become stale.
  
  i Use page.locator() or getByRole() instead.
  
  i This rule belongs to the nursery group, which means it is not yet stable and may change in the future. Visit https://biomejs.dev/linter/#nursery for more information.
  
  i Unsafe fix: Replace $() with locator().
  
     3  3 │   const button1 = await (await page.$("button"));
     4  4 │   
     5    │ - const·button2·=·await·page.$("#foo");
        5 │ + const·button2·=·await·page.locator("#foo");
     6  6 │   
     7  7 │   await (await page.$$("div"));
  

```

```
nested-calls.js:7:14 lint/nursery/noPlaywrightElementHandle  FIXABLE  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  i Unexpected use of element handles.
  
    5 │ const button2 = await page.$("#foo");
    6 │ 
  > 7 │ await (await page.$$("div"));
      │              ^^^^^^^^^^^^^^
    8 │ 
    9 │ let handle;
  
  i Locators auto-wait and are more reliable than element handles, which can become stale.
  
  i Use page.locator() or getByRole() instead.
  
  i This rule belongs to the nursery group, which means it is not yet stable and may change in the future. Visit https://biomejs.dev/linter/#nursery for more information.
  
  i Unsafe fix: Replace $$() with locator().
  
     5  5 │   const button2 = await page.$("#foo");
     6  6 │   
     7    │ - await·(await·page.$$("div"));
        7 │ + await·(await·page.locator("div"));
     8  8 │   
     9  9 │   let handle;
  

```

```
nested-calls.js:10:16 lint/nursery/noPlaywrightElementHandle  FIXABLE  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  i Unexpected use of element handles.
  
     9 │ let handle;
  > 10 │ handle = await page.$("input");
       │                ^^^^^^^^^^^^^^^
    11 │ 
  
  i Locators auto-wait and are more reliable than element handles, which can become stale.
  
  i Use page.locator() or getByRole() instead.
  
  i This rule belongs to the nursery group, which means it is not yet stable and may change in the future. Visit https://biomejs.dev/linter/#nursery for more information.
  
  i Unsafe fix: Replace $() with locator().
  
     8  8 │   
     9  9 │   let handle;
    10    │ - handle·=·await·page.$("input");
       10 │ + handle·=·await·page.locator("input");
    11 11 │   
  

```
